# Домашнее задание к занятию «Микросервисы: масштабирование»

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: Кластеризация

Предложите решение для обеспечения развёртывания, запуска и управления приложениями.
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- поддержка контейнеров;
- обеспечивать обнаружение сервисов и маршрутизацию запросов;
- обеспечивать возможность горизонтального масштабирования;
- обеспечивать возможность автоматического масштабирования;
- обеспечивать явное разделение ресурсов, доступных извне и внутри системы;
- обеспечивать возможность конфигурировать приложения с помощью переменных среды, в том числе с возможностью безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т. п.

Обоснуйте свой выбор.

Для обеспечения развёртывания, запуска и управления приложениями, соответствующих указанным требованиям, я предлагаю использовать стек технологий, состоящий из следующих компонентов:

- **Docker** – для контейнеризации приложений.
- **Kubernetes** – для оркестрации контейнеров.
- **Helm** – для управления пакетами приложений в Kubernetes.
- **Istio (или другой сервис-меш)** – для управления сетевыми взаимодействиями между сервисами.
- **Prometheus и Grafana** – для мониторинга и визуализации метрик.
- **HashiCorp Vault** – для безопасного хранения и управления чувствительными данными.

# Обоснование выбора:

**Поддержка контейнеров:**
- Docker позволяет упаковывать приложения и их зависимости в контейнеры, что обеспечивает их переносимость и согласованность в разных средах.

**Обнаружение сервисов и маршрутизация запросов:**
- Kubernetes предоставляет встроенные механизмы для обнаружения сервисов через DNS и позволяет настраивать маршрутизацию запросов между ними.
- Istio добавляет дополнительные возможности для управления трафиком, такие как канареечные развертывания, маршрутизация на основе заголовков и т. д.

**Горизонтальное масштабирование:**
- Kubernetes поддерживает автоматическое горизонтальное масштабирование на основе метрик нагрузки (например, CPU или памяти) с помощью Horizontal Pod Autoscaler.

**Автоматическое масштабирование:**
- Kubernetes позволяет настроить автоматическое масштабирование подов на основе метрик, что обеспечивает возможность динамического изменения количества экземпляров приложения в зависимости от нагрузки.

**Явное разделение ресурсов:**
- Kubernetes использует концепцию пространств имен (namespaces), что позволяет разделять ресурсы между различными командами или проектами. С помощью сетевых политик можно ограничить доступ к сервисам внутри кластера.

**Конфигурация приложений с помощью переменных среды:**
- Kubernetes позволяет задавать переменные окружения для контейнеров через ConfigMaps и Secrets.
- HashiCorp Vault обеспечивает безопасное хранение и управление чувствительными данными, такими как пароли и ключи доступа, и интегрируется с Kubernetes для динамического получения секретов.

**Принципы взаимодействия компонентов:**
- Docker используется для создания образов приложений, которые затем разворачиваются в Kubernetes.
- Kubernetes управляет жизненным циклом контейнеров, обеспечивает их автоматическое масштабирование и предоставляет механизмы для обнаружения сервисов.
- Istio интегрируется с Kubernetes для управления сетевыми взаимодействиями, обеспечивая безопасность и контроль над трафиком между сервисами.
- Prometheus собирает метрики из Kubernetes и приложений, а Grafana визуализирует эти метрики, предоставляя информацию о производительности и состоянии системы.
- HashiCorp Vault используется для безопасного хранения секретов и интегрируется с Kubernetes для автоматического предоставления секретов контейнерам.

Предложенное решение обеспечивает надежную и масштабируемую архитектуру для развертывания и управления приложениями, соответствующую всем указанным требованиям. Использование контейнеров и оркестрации позволяет эффективно управлять ресурсами и адаптироваться к изменениям нагрузки, а интеграция с инструментами для мониторинга и управления секретами повышает уровень безопасности и удобства в эксплуатации.

## Задача 2: Распределённый кеш * (необязательная)

Разработчикам вашей компании понадобился распределённый кеш для организации хранения временной информации по сессиям пользователей.
Вам необходимо построить Redis Cluster, состоящий из трёх шард с тремя репликами.

### Схема:

![11-04-01](https://user-images.githubusercontent.com/1122523/114282923-9b16f900-9a4f-11eb-80aa-61ed09725760.png)

---

### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---
